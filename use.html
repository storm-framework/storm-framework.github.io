<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    
    <head>
   <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-106786912-1">
    </script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());
      gtag('config', 'UA-106786912-1');
    </script>


     <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <!--
      loads the http over https ssl -
      welcome to my website!

	this theme is based off the Ice & Fire theme created by Lucas Gatsas
      https://www.twitter.com/LucasGatsas
      www.lucasgatsas.ch - switzerland.
  -->


<!-- Microsoft Internet Explorer documentMode compatMode setting IE Modus -->
<script type="text/javascript">
var IE = null;
if (window.navigator.appName == "Microsoft Internet Explorer") {
  if (document.documentMode) {

    IE = document.documentMode;
    } else {

        IE = 5;
          if (document.compatMode) {
      if (document.compatMode == "CSS1Compat")
      IE = 11;
      }
    }
  }
</script>

    <meta charset="utf-8">
    <!-- X-UA -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <link rel="author" title="Ranjit Jhala" href="http://ranjitjhala.github.io" />

    <meta name="google" content="notranslate" />
    <!-- Viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- index ROBOTS follow -->
    <meta name="robots" content="index, follow" />
    <!-- Site Desciption -->
    <meta name="description" content="STORM Web Framework">
    <!-- Site Desciption -->
    <meta name="keywords" content="haskell, refinement types, liquid types, formal methods, type systems">
    <!-- Favicon -->
    <link rel="shortcut icon" href="https://storm-framework.github.io/static/img/ico.png" type="image/x-icon" />
    <!-- Blog Title -->
    <title>STORM</title>

    <!--     <title>{% if page.title %}{{ page.title }} - {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
-->
    <!-- Property Metas -->
    <meta property="og:image" content="https://storm-framework.github.io/static/img/ix.png" />
    <meta property="og:title" content="STORM Web Framework" />
    <meta property="og:site_name" content="STORM Web Framework" />
    <!-- Canonical -->
    <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseUrl | prepend: site.url }}">
    <!-- StyleSheet -->
    <link rel="stylesheet" href="https://storm-framework.github.io/static/css/bootstrap.min.css">
    <!-- <link rel="stylesheet" href="https://storm-framework.github.io/static/css/spaceg.stylesheets.css"> -->
    <link rel="stylesheet" href="static/css/ronacher.css" type="text/css">
    <link rel="stylesheet" href="static/css/syntax.css">
    <link rel="stylesheet" href="static/css/liquid-light.css">

    <!-- Fonts
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Playfair+Display:400,700,900,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
    -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
	#preloader {position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff; /* change if the mask should have another color then white */z-index:99; /* makes sure it stays on top */}
	#status {width:200px;height:200px;position:absolute;left:50%; /* centers the loading animation horizontally one the screen */top:50%; /* centers the loading animation vertically one the screen */background-image:url("/static/img/preloader.gif"); /* path to your loading animation */background-repeat:no-repeat;background-position:center;margin:-100px 0 0 -100px; /* is width and height divided by two */}
	ul, ol {margin-top: 0;margin-bottom: 10px;}
	.navbar-inverse {background-color: #FFF;border-color: #FFFFFF;}
</style>
<!--link rel="stylesheet" href="https://storm-framework.github.io/static/css/prettify.css"-->
<style>
  /* HEADER IMAGE */
  header.intro-header {background: #6f5499;background: no-repeat center center;background-attachment: scroll;-webkit-background-size: cover;-moz-background-size: cover;background-size: cover;-o-background-size: cover;}

	/* Preloader */#preloader {position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff; /* change if the mask should have another color then white */z-index:99; /* makes sure it stays on top */}
	#status {width:200px;height:200px;position:absolute;left:50%; /* centers the loading animation horizontally one the screen */top:50%; /* centers the loading animation vertically one the screen */background-image:; /* path to your loading animation */background-repeat:no-repeat;background-position:center;margin:-100px 0 0 -100px; /* is width and height divided by two */}
	li {list-style: none;}
            body.modal-open
            {overflow: hidden;padding-right: 0px;
        }
	article li {list-style: inherit;}
	article .figure {text-align: center}
    </style>
    <!-- end Loading front stylesheet here -->

    <link href="atom.xml" type="application/atom+xml" rel="alternate" title="LiquidHaskell-Blog ATOM Feed" />
    </head>

    <body>
	    
	<!-- 	
        <div id="preloader">
	    <div id="status">
	    </div>
	</div>  
	-->
	<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://storm-framework.github.io/index.html" id="blog-title-left-top">STORM</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="https://cseweb.ucsd.edu/~npolikarpova/publications/osdi21.pdf" target="_blank">Paper</a></li>
                <li><a href="policies.html">Policies</a></li>
                <li><a href="use.html">Use</a></li>
                <li><a href="http://www.github.com/storm-framework/storm"><i class="fa fa-github"></i>Code</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<!-- Portfolio Modals -->
    <div class="portfolio-modal modal fade" id="portfolioModal1" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Menu Modals Add New Sa.21.Feb.2015 03:22:25 -->
    <div class="portfolio-modal modal fade" id="portfolioModal2" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
        
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <h1 class="font-style-inline-small-h1">STORM Web Framework</h1>
                            <hr class="star-primary">
                            <p class="font-style-inline-small">
                            <li><a href="https://cseweb.ucsd.edu/~npolikarpova/publications/osdi21.pdf" target="_blank">Paper</a></li>
                            <li><a href="policies.html">Policies</a></li>
                            <li><a href="use.html">Use</a></li>
                            <li><a href="http://www.github.com/storm-framework/storm"><i class="fa fa-github"></i>Code</a></li>
                            <li><a href="about.html">About</a></li>
                            </p>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>


        <div id="content">
            
<!-- Post Header -->
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
		<div class="post-heading">
                    
                      <p>  </p>
                    
		</div>
            </div>
        </div>
    </div>
</header>

<!-- Splash Page -->


<!-- Post Content -->
<article>
<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <p><img src="./static/img/storm-logo-2.png" /></p>
<hr>
<h1 id="installation-and-use">Installation and Use</h1>
<hr>
<p><br></p>
<p>This tutorial/demo that shows how to build web-apps with STORM. Like STORM, the demo focuses only on the web-server <em>back-end</em>. You can use your favorite front-end framework to write the <em>client</em>. For examples, look at <a href="https://github.com/storm-framework/voltron">voltron</a> and <a href="https://github.com/storm-framework/disco">disco</a>, two complete applications we built with STORM and <a href="https://vuejs.org/">vue.js</a>.</p>
<br>
<hr>
<p><br></p>
<h2 id="prerequisites">Prerequisites</h2>
<p><br></p>
<p>STORM has two dependencies: the Haskell build tool <code>stack</code> and the SMT solver <code>z3</code>.</p>
<ol type="1">
<li><p><a href="https://docs.haskellstack.org/en/stable/README/">stack v2.5.1</a> Install using <a href="https://docs.haskellstack.org/en/stable/README/#how-to-install">these instructions</a></p></li>
<li><p><a href="https://github.com/Z3Prover/z3/releases/tag/z3-4.8.8">z3 v4.8.8</a> Install by placing a copy of the precompiled <code>z3</code> binary in your <code>$PATH</code>. You can ignore the shared libraries and bindings for Java and Python.</p></li>
</ol>
<p>Additionally this demo will use <a href="https://curl.se/"><code>curl</code></a> to test our app as we go.</p>
<br>
<hr>
<p><br></p>
<h2 id="install">Install</h2>
<p><br></p>
<p>The easiest way to get started is to download the starter <em>template</em> app</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>$ <span class="fu">git</span> clone git@github.com:storm-framework/demo.git storm-app</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>$ <span class="bu">cd</span> storm-app</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>$ <span class="fu">git</span> checkout v0</span></code></pre></div>
<p>This tutorial is split into multiple pieces or versions which can be found in the the cloned repo as branches <code>v0</code>, <code>v1</code>, <code>v2</code>, <code>v3</code>, <code>v4</code>, and <code>v5</code>. You can skip ahead and look at the progression via</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>$ <span class="fu">git</span> diff v0..v1</span></code></pre></div>
<br>
<hr>
<p><br></p>
<h2 id="architecture">Architecture</h2>
<p><br></p>
<p>A STORM app has the following essential components.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>File</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="src/Model.storm"><code>Models.storm</code></a></td>
<td style="text-align: left;">Model-policy file</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="src/Routes.hs"><code>Routes.hs</code></a></td>
<td style="text-align: left;">Route-controller mapping</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="src/Types.hs"><code>Types.hs</code></a></td>
<td style="text-align: left;">Global type definitions</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="src/Config.hs"><code>Config.hs</code></a></td>
<td style="text-align: left;">Configuration options (e.g. env variables)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="src/Controllers/"><code>Controllers/</code></a></td>
<td style="text-align: left;">Controller implementations</td>
</tr>
</tbody>
</table>
<br>
<hr>
<p><br></p>
<h2 id="build">Build</h2>
<p><br></p>
<p>You can build the web-app by typing</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>$ <span class="fu">make</span> build</span></code></pre></div>
<p>This will take a <em>long while</em> to download all the dependencies, including building the LiquidHaskell verifier. Grab some coffee, like some tweets, brush your teeth, or go for a jog. Fortunately, you only need to do this once; subsequent <code>make</code> should be quick.</p>
<br>
<hr>
<p><br></p>
<h2 id="version-0-kick-the-tires">Version 0: Kick the Tires</h2>
<p><br></p>
<p>Lets kick the tires to make sure stuff is working.</p>
<p><br></p>
<h3 id="step-1.-fire-up-the-server">Step 1. Fire up the server</h3>
<p><br></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>$ <span class="fu">make</span></span></code></pre></div>
<p>You should see the following at your terminal</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="ex">Starting</span> server at: host = <span class="st">&quot;127.0.0.1&quot;</span>, port = 3000</span></code></pre></div>
<p><br></p>
<h3 id="step-2.-test">Step 2. Test</h3>
<p><br></p>
<p>In a <em>separate</em> terminal test your server with <code>curl</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>$ <span class="ex">curl</span> http://localhost:3000/api/ping</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="st">&quot;pong&quot;</span></span></code></pre></div>
<br>
<hr>
<p><br></p>
<h2 id="version-1-routes-and-controllers">Version 1: Routes and Controllers</h2>
<p><br></p>
<p>(You can “cheat” by switching to the branch <code>v1</code> in the repo.)</p>
<p>Next, lets add our first route and its controller.</p>
<p><br></p>
<h3 id="step-1-add-a-route">Step 1: Add a Route</h3>
<p><br></p>
<p>Edit <code>src/Routes.hs</code> so that the definition of <code>routes</code> looks like</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="ot">routes ::</span> [<span class="dt">Route</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>routes <span class="ot">=</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>  [ post <span class="st">&quot;/api/signin&quot;</span>    signIn</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>  , post <span class="st">&quot;/api/signout&quot;</span>   signOut</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>  , get  <span class="st">&quot;/api/ping&quot;</span>      pong</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>  , get  <span class="st">&quot;/api/list/:uid&quot;</span> list     <span class="co">-- add this line</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>  ]</span></code></pre></div>
<p><br></p>
<h3 id="step-2-implement-a-controller">Step 2: Implement a Controller</h3>
<p><br></p>
<p>Edit <code>src/Controllers/List.hs</code> to add the following definition that simply responds with a string repeating the <code>UserId</code> and the current time.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co">{-@ list :: UserId -&gt; TaggedT&lt;{\_ -&gt; False}, {\_ -&gt; True}&gt; _ _ _ @-}</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="ot">list ::</span> <span class="dt">UserId</span> <span class="ot">-&gt;</span> <span class="dt">Controller</span> ()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>list uid <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>  time   <span class="ot">&lt;-</span> getTime</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>  <span class="kw">let</span> msg <span class="ot">=</span> <span class="st">&quot;OK: hello &quot;</span> <span class="op">&lt;&gt;</span> tShow uid <span class="op">&lt;&gt;</span> <span class="st">&quot; at &quot;</span> <span class="op">&lt;&gt;</span><span class="ot"> time ::</span> <span class="dt">T.Text</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>  respondJSON status200 msg </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a><span class="ot">getTime ::</span> <span class="dt">Controller</span> <span class="dt">T.Text</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>getTime <span class="ot">=</span> tShow <span class="op">&lt;$&gt;</span> liftTIO currentTime</span></code></pre></div>
<p>The text inside <code>{-@ ... @-}</code> is a <a href="https://ucsd-progsys.github.io/liquidhaskell-blog/">refinement type signature</a> that tells the verifier that <code>list</code> is a <em>top-level</em> controller. For more details see [the paper].</p>
<p><br></p>
<h3 id="step-3-test">Step 3: Test</h3>
<p><br></p>
<p>Run <code>scripts/test_1.sh</code> to test your new route and controller!</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>$ <span class="ex">./scripts/test_1.sh</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="ex">list</span> ... returns current time UTC</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="st">&quot;OK: hello ... {unSqlBackendKey = 1} at 2021-07-13 22:53:25.51654 UTC&quot;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="ex">list</span> ... returns current time UTC</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a><span class="st">&quot;OK: hello ... {unSqlBackendKey = 2} at 2021-07-13 22:53:25.5285 UTC&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="ex">list</span> ... returns current time UTC</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a><span class="st">&quot;OK: hello ... {unSqlBackendKey = 3} at 2021-07-13 22:53:25.537898 UTC&quot;</span></span></code></pre></div>
<br>
<hr>
<p><br></p>
<h2 id="version-2-adding-authentication">Version 2: Adding Authentication</h2>
<p><br></p>
<p>Lets look at the model-policy file <code>src/Models.storm</code></p>
<p>The <code>User</code> table defines the set of users of the app.</p>
<pre><code>User
  emailAddress  Text
  password      ByteString
  firstName     Text
  lastName      Text
  UniqueEmailAddress emailAddress</code></pre>
<p><br></p>
<h3 id="step-1-require-authentication">Step 1: Require Authentication</h3>
<p><br></p>
<p>Lets modify the <code>list</code> controller (in <code>src/Controllers/List.hs</code>) to use <code>requireAuthUser</code> which succeeds only when the request is from a logged in user.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co">{-@ list :: UserId -&gt; TaggedT&lt;{\_ -&gt; False}, {\_ -&gt; True}&gt; _ _ _ @-}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="ot">list ::</span> <span class="dt">UserId</span> <span class="ot">-&gt;</span> <span class="dt">Controller</span> ()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>list uid <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>  requireAuthUser</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>  time   <span class="ot">&lt;-</span> getTime</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>  user   <span class="ot">&lt;-</span> selectFirstOr notFoundJSON (userId' <span class="op">==.</span> uid)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>  userNG <span class="ot">&lt;-</span> extractUserNG user</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>  <span class="kw">let</span> msg <span class="ot">=</span> <span class="st">&quot;OK: &quot;</span> <span class="op">&lt;&gt;</span> tShow userNG <span class="op">&lt;&gt;</span> <span class="st">&quot; at &quot;</span> <span class="op">&lt;&gt;</span> time</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>  respondJSON status200 msg </span></code></pre></div>
<p>Additionally, notice that</p>
<ol type="1">
<li><p>We use the query <code>selectFirstOr</code> with the query <code>(userId' ==. uid)</code> to find the first record in the <code>User</code> table whose primary key equals <code>uid</code> – i.e. to find the record for <code>uid</code> if it exists or else, respond with <code>Not Found</code>.</p></li>
<li><p>We use <code>extractUserNG</code>, which internally, uses <code>project</code> to pull out the values of individual field of the <code>user</code> record to build the pure value <code>userNG</code> sent back to the client.</p></li>
</ol>
<p><br></p>
<h3 id="step-2-test">Step 2: Test</h3>
<p><br></p>
<p>Run <code>make</code> to build and run the server in one terminal.</p>
<p>In another test your updated controller with <code>scripts/test_2.sh</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="ex">add</span> users</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="ex">...</span> INFO: addUser: CreateUser {crUserEmail = <span class="st">&quot;alice@st.orm&quot;</span> ...} </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="ex">...</span> INFO: addUser: CreateUser {crUserEmail = <span class="st">&quot;bob@st.orm&quot;</span> ...}</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="ex">...</span> INFO: addUser: CreateUser {crUserEmail = <span class="st">&quot;carlos@st.orm&quot;</span> ...} </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a><span class="ex">list</span> ... returns nothing</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="ex">sign-in</span> first!</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Alice&quot;,&quot;lastName&quot;:&quot;Waters&quot;}</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a><span class="ex">list</span> ... now succeeds</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a><span class="st">&quot;OK: UserNG {userFirstName = </span><span class="dt">\&quot;</span><span class="st">Alice</span><span class="dt">\&quot;</span><span class="st">, userLastName = </span><span class="dt">\&quot;</span><span class="st">Waters</span><span class="dt">\&quot;</span><span class="st">} ...&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a><span class="ex">list</span> ... now succeeds</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a><span class="st">&quot;OK: UserNG {userFirstName = </span><span class="dt">\&quot;</span><span class="st">Robert</span><span class="dt">\&quot;</span><span class="st">, userLastName = </span><span class="dt">\&quot;</span><span class="st">Barron</span><span class="dt">\&quot;</span><span class="st">} ...&quot;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a><span class="ex">list</span> ... returns {} <span class="fu">as</span> no such user</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a>{}</span></code></pre></div>
<p>Note that we don’t get any response until we’re signed in.</p>
<br>
<hr>
<p><br></p>
<h2 id="version-3-adding-items">Version 3: Adding Items</h2>
<p><br></p>
<p>Next, lets start populating our users’ lists with some items!</p>
<p><br></p>
<h3 id="step-1-add-a-database-table">Step 1: Add a Database Table</h3>
<p><br></p>
<p>First, lets make an <code>Item</code> table by editing <code>src/Models.storm</code> to include</p>
<pre><code>Item
  owner         UserId
  description   Text
  level         String</code></pre>
<p>Similarly, we want a JSON-compatible pure representation of <code>Item</code> so edit <code>src/Types.hs</code> to</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">data</span> <span class="dt">ItemData</span> <span class="ot">=</span> <span class="dt">ItemData</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>  {<span class="ot"> itemDescription ::</span> <span class="dt">Text</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>  ,<span class="ot"> itemLevel       ::</span> <span class="dt">String</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>  }</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>  <span class="kw">deriving</span> (<span class="dt">Show</span>, <span class="dt">Generic</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a><span class="ot">mkItemData ::</span> <span class="dt">Text</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">ItemData</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a>mkItemData descr levl <span class="ot">=</span> <span class="dt">ItemData</span> (strip descr) (sStrip levl)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a><span class="kw">instance</span> <span class="dt">FromJSON</span> <span class="dt">ItemData</span> <span class="kw">where</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a>  parseJSON <span class="ot">=</span> genericParseJSON (stripPrefix <span class="st">&quot;item&quot;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a><span class="kw">instance</span> <span class="dt">ToJSON</span> <span class="dt">ItemData</span> <span class="kw">where</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a>  toEncoding <span class="ot">=</span> genericToEncoding (stripPrefix <span class="st">&quot;item&quot;</span>)</span></code></pre></div>
<p><br></p>
<h3 id="step-2-implement-the-api-to-add-items">Step 2: Implement the API to Add Items</h3>
<p><br></p>
<p>Next, lets make a new API endpoint to insert items for a user</p>
<p>Edit <code>src/Routes.hs</code> to include</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="ot">routes ::</span> [<span class="dt">Route</span>]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>routes <span class="ot">=</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>  [ post <span class="st">&quot;/api/signin&quot;</span>    signIn</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>  , post <span class="st">&quot;/api/signout&quot;</span>   signOut</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>  , get  <span class="st">&quot;/api/ping&quot;</span>      pong</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>  , get  <span class="st">&quot;/api/list/:uid&quot;</span> list</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>  , get  <span class="st">&quot;/api/add&quot;</span>       add</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a>  ]</span></code></pre></div>
<p>Edit <code>src/Controllers/List.hs</code> to include the controller</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="co">{-@ add :: TaggedT&lt;{\_ -&gt; True}, {\_ -&gt; True}&gt; _ _ _ @-}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="ot">add ::</span> <span class="dt">Controller</span> ()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>add <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>  owner   <span class="ot">&lt;-</span> requireAuthUser</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>  ownerId <span class="ot">&lt;-</span> project userId' owner</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a>  ownerEm <span class="ot">&lt;-</span> project userEmailAddress' owner</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>  items   <span class="ot">&lt;-</span> decodeBody</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>  items'  <span class="ot">&lt;-</span> mapT (\<span class="dt">ItemData</span> {<span class="op">..</span>} <span class="ot">-&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>              insert (mkItem ownerId itemDescription itemLevel)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>             ) items</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>  <span class="kw">let</span> msg <span class="ot">=</span> <span class="st">&quot;OK: add &quot;</span> <span class="op">&lt;&gt;</span> tShow (<span class="fu">length</span> items') <span class="op">&lt;&gt;</span> <span class="st">&quot; items &quot;</span> <span class="op">&lt;&gt;</span> ownerEm</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a>  respondJSON status200 msg</span></code></pre></div>
<p>Note how the controller</p>
<ol type="1">
<li>Finds the <code>ownerId</code> and <code>ownerEmail</code> using <code>requireAuthUser</code> and <code>project</code></li>
<li>Extracts the JSON payload via <code>decodeBody</code></li>
<li>Uses <code>mkItem</code> to create the <code>Item</code> records and</li>
<li>Uses <code>insert</code> to add the records to the DB.</li>
</ol>
<p><br></p>
<h3 id="step-3-modify-list-return-items">Step 3: Modify <code>list</code> Return Items</h3>
<p><br></p>
<p>Next, lets update <code>list</code> to return the items of the given <code>UserId</code> (instead of just responding with their names…). Edit the <code>src/Controllers/List.hs</code> so that</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>list userId <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>  items  <span class="ot">&lt;-</span> selectList (itemOwner' <span class="op">==.</span> userId)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>  itemDs <span class="ot">&lt;-</span> mapT (\i <span class="ot">-&gt;</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>              <span class="dt">ItemData</span> <span class="ot">`fmap`</span> project itemDescription' i</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>                       <span class="op">&lt;*&gt;</span>    project itemLevel' i</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>              ) items</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>  respondJSON status200 itemDs</span></code></pre></div>
<p>Now, notice that first <code>selectList</code> is invoked with a query asking for all the <code>Item</code>s whose <code>owner</code> is <code>userId</code>. Next, we build a response object by <code>project</code>ing the <code>description</code> and <code>level</code> values of each record in <code>items</code> to build an array of JSON objects that is sent back to the client.</p>
<h3 id="step-4-test">Step 4: Test</h3>
<p>The file <code>scripts/alice_json</code> has a few items for <code>alice</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>$ <span class="fu">more</span> scripts/items_alice.json</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="bu">[</span> <span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>  <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a>  {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;marley and me&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;private&quot;</span>},</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>  {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;daniel tiger&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;follower&quot;</span>},</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>  <span class="dt">{&quot;description&quot;:&quot;lupin&quot;,&quot;level&quot;:&quot;follower&quot;}</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a><span class="bu">]</span></span></code></pre></div>
<p>Lets test the app by adding and querying the server for those items</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>$ <span class="ex">./scripts/test_3.sh</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a><span class="ex">*********</span> add users</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a><span class="ex">********</span> sign-in alice!</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Alice&quot;,&quot;lastName&quot;:&quot;Waters&quot;}</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a><span class="ex">********</span> add items for alice</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a><span class="st">&quot;OK: add 5 items for alice@st.orm&quot;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a><span class="ex">*******</span> logout</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a><span class="ex">********</span> sign-in alice!</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Alice&quot;,&quot;lastName&quot;:&quot;Waters&quot;}</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;marley and me&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;private&quot;</span>},</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;daniel tiger&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;follower&quot;</span>},</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;lupin&quot;,&quot;level&quot;:&quot;follower&quot;}</span>]</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true"></a><span class="ex">********</span> logout</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true"></a><span class="ex">********</span> sign-in bob!</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Robert&quot;,&quot;lastName&quot;:&quot;Barron&quot;}</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;marley and me&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;private&quot;</span>},</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;daniel tiger&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;follower&quot;</span>},</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;lupin&quot;,&quot;level&quot;:&quot;follower&quot;}</span>]</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true"></a><span class="ex">********</span> logout</span></code></pre></div>
<br>
<hr>
<p><br></p>
<h2 id="version-4-restrict-to-public-items">Version 4: Restrict to Public Items</h2>
<p><br></p>
<p>Oops, we hit a bit of a snag – <code>bob</code> (or anyone for that matter!) can see <em>all</em> of <code>alice</code>’s items – even the ones marked <code>"private"</code>!</p>
<p><br></p>
<h3 id="step-1-specify-a-security-policy">Step 1: Specify a Security Policy</h3>
<p><br></p>
<p>Lets specify that only items marked <code>"public"</code> should be visible to users <em>other</em> than the owner, who should, of course, be able to see all their own items.</p>
<p>Edit <code>src/Models.storm</code> to <em>include</em> two predicates</p>
<ol type="1">
<li><code>IsOwner item viewer</code> which is true when <code>viewer</code> owns <code>item</code>,</li>
<li><code>IsPublic item</code> which is true when the <code>item</code> is marked <code>"public"</code>.</li>
</ol>
<pre><code>policy IsOwner = \item viewer -&gt;
  itemOwner item == entityKey viewer

policy IsPublic = \item -&gt;
  itemLevel item == &quot;public&quot;

policy OwnPublic = \item viewer -&gt; 
  IsOwner item viewer || IsPublic item</code></pre>
<p>and further add a <code>read</code> clause to restrict <code>description</code> the owner-unless-marked-public</p>
<pre><code>Item
  Item
  owner         UserId
  description   Text
  level         String
  read   [ description ] @OwnPublic </code></pre>
<p>Now when you run <code>make</code>, compilation fails with a type error!</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="ex">****</span> LIQUID: UNSAFE **************************************************</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="ex">../storm-demo/src/Controllers</span>/List.hs:<span class="ex">43</span>:40: error:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>    <span class="ex">Liquid</span> Type Mismatch</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>    <span class="ex">...</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>   <span class="kw">|</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a><span class="ex">43</span> <span class="kw">|</span>                <span class="ex">ItemData</span> <span class="kw">`</span><span class="ex">fmap</span><span class="kw">`</span> project itemDescription<span class="st">' i</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a><span class="st">   |                                        ^^^^^^^^^^^^^^^^</span></span></code></pre></div>
<p>STORM is unimpressed as <code>selectList</code> yields all of <code>userId</code>’s items but the <em>viewer</em> can be someone else who is not allowed (per <code>OwnPublic</code>) to view those <code>description</code>s!</p>
<p><br></p>
<h3 id="step-2.-fix-the-controller">Step 2. Fix the Controller</h3>
<p><br></p>
<p>Lets fix the controller by checking if the viewer is <code>userId</code> and otherwise, by conjoining the query with a clause that the <code>Item</code>’s level be <code>"public"</code>. Edit <code>src/Controllers/List.hs</code> so that <code>list</code> looks like</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co">{-@ list :: UserId -&gt; TaggedT&lt;{\_ -&gt; False}, {\_ -&gt; True}&gt; _ _ _ @-}</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="ot">list ::</span> <span class="dt">UserId</span> <span class="ot">-&gt;</span> <span class="dt">Controller</span> ()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>list userId <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>  viewId  <span class="ot">&lt;-</span> project userId' <span class="op">=&lt;&lt;</span> requireAuthUser</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a>  <span class="kw">let</span> pub  <span class="ot">=</span> <span class="kw">if</span> userId <span class="op">==</span> viewId </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>               <span class="kw">then</span> trueF </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a>               <span class="kw">else</span> itemLevel' <span class="op">==.</span> <span class="st">&quot;public&quot;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a>  items   <span class="ot">&lt;-</span> selectList (itemOwner' <span class="op">==.</span> userId <span class="op">&amp;&amp;:</span> pub)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a>  itemDs  <span class="ot">&lt;-</span> mapT (\i <span class="ot">-&gt;</span> <span class="dt">ItemData</span> <span class="ot">`fmap`</span> project itemDescription' i</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a>                                  <span class="op">&lt;*&gt;</span>    project itemLevel'       i</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a>                  ) items</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a>  respondJSON status200 itemDs</span></code></pre></div>
<p><br></p>
<h3 id="step-3.-test">Step 3. Test</h3>
<p><br></p>
<p>STORM gladly verifies that the fix controller is policy compliant! Lets test our server to make sure that only public items are shown to users other than <code>alice</code></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>$ <span class="ex">scripts/test_3.sh</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="ex">*********</span> add users</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a><span class="ex">********</span> sign-in alice!</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Alice&quot;,&quot;lastName&quot;:&quot;Waters&quot;}</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a><span class="ex">********</span> add items for alice</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a><span class="st">&quot;OK: add 5 items for alice@st.orm&quot;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a><span class="ex">*******</span> logout</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a><span class="ex">********</span> sign-in alice!</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Alice&quot;,&quot;lastName&quot;:&quot;Waters&quot;}</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;marley and me&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;private&quot;</span>},</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;daniel tiger&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;follower&quot;</span>},</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;lupin&quot;,&quot;level&quot;:&quot;follower&quot;}</span>]</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true"></a><span class="ex">********</span> logout</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true"></a><span class="ex">********</span> sign-in bob!</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Robert&quot;,&quot;lastName&quot;:&quot;Barron&quot;}</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>]</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true"></a><span class="ex">********</span> logout</span></code></pre></div>
<p>Note that <code>bob</code> only gets to see the subset of <code>public</code> items.</p>
<br>
<hr>
<p><br></p>
<h2 id="version-5-restrict-to-followers">Version 5 : Restrict to Followers</h2>
<p><br></p>
<p>As a last step, lets add a feature where a user can <em>share</em> some of their items with <em>followers</em>.</p>
<p><br></p>
<h3 id="step-1.-add-followers-to-the-model">Step 1. Add Followers to the Model</h3>
<p><br></p>
<p>Add the below definitions to represent the followers relationship in <code>src/Models.storm</code>.</p>
<pre><code>predicate follows :: UserId -&gt; UserId -&gt; Bool

Follower
  subscriber UserId
  publisher  UserId
  status     String

  assert     {status == &quot;accepted&quot; =&gt; follows subscriber publisher}</code></pre>
<p>The <code>Follower</code> table records the actual relationship. The <code>predicate follows</code> reflects the relationship at the logical “policy” level, using the <code>assert</code> clause which says that <em>each</em> tuple in the <code>Follower</code> table <em>bears witness</em> to the fact that its subscriber field follows its publisher field, <em>when</em> the <code>status</code> field has the value <code>"accepted"</code>. (This lets one user <em>initiate</em> the relationship, which is only cemented when the other user <em>accepts</em>.)</p>
<p><br></p>
<h3 id="step-2.-modify-policy-to-allow-followers-access">Step 2. Modify Policy to Allow Followers Access</h3>
<p><br></p>
<p>Next, lets update the policies for <code>Item</code> to allow the owner’s followers to read the <code>description</code>. Edit <code>src/Models.storm</code> to define</p>
<pre><code>policy IsFollower = \item viewer -&gt;
  itemLevel item == &quot;follower&quot; &amp;&amp; 
  follows (entityKey viewer) (itemOwner item)

policy OwnFollowPub = \item viewer -&gt; 
  IsOwner    item viewer ||
  IsFollower item viewer || 
  IsPublic   item</code></pre>
<p>and then edit the <code>read</code> clause with the new <code>OwnFollowPub</code> policy</p>
<pre><code>Item
  owner       UserId
  description Text
  level       String

  read [ description ] @OwnFollowPub</code></pre>
<p><br></p>
<h3 id="step-3.-update-the-controller">Step 3. Update the Controller</h3>
<p><br></p>
<p>The old controller <em>should</em> still compile – but its not what we want as it still only shows the <code>public</code> items to other users.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>$ <span class="ex">script/test_5.sh</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a><span class="ex">*********</span> add users</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a><span class="ex">********</span> bob follows alice</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a><span class="ex">********</span> sign-in bob!</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Robert&quot;,&quot;lastName&quot;:&quot;Barron&quot;}</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>]</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true"></a><span class="ex">********</span> logout</span></code></pre></div>
<p>Of course, we have to change how the controller behaves as well, by making it issue queries that also return <code>"follower"</code> level items. Edit <code>src/Controllers/List.hs</code> to include a function <code>checkFollower vId uId</code> that queries the database to determine whether <code>vId</code> is a follower of <code>uId</code></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co">{-@ checkFollower ::</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a><span class="co">      vId:_ -&gt; uId:_ -&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="co">      TaggedT&lt;{\_ -&gt; True}, {\_ -&gt; False}&gt; _ _ {b:_|b =&gt; follows vId uId}</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a><span class="co">  @-}</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a><span class="ot">checkFollower ::</span> <span class="dt">UserId</span> <span class="ot">-&gt;</span> <span class="dt">UserId</span> <span class="ot">-&gt;</span> <span class="dt">Controller</span> <span class="dt">Bool</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>checkFollower vId uId <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>  flws <span class="ot">&lt;-</span> selectList (followerSubscriber' <span class="op">==.</span> vId <span class="op">&amp;&amp;:</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a>                      followerPublisher' <span class="op">==.</span> uId)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a>  <span class="kw">case</span> flws <span class="kw">of</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a>    [] <span class="ot">-&gt;</span> <span class="fu">return</span> <span class="dt">False</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a>    _  <span class="ot">-&gt;</span> <span class="fu">return</span> <span class="dt">True</span></span></code></pre></div>
<p>The text inside <code>{-@ ... @-}</code> says that <code>checkFollower</code> is a <em>read-only</em> controller, that accesses data visible to <em>all</em> users (<code>True</code>) and sends data to <em>no</em> users (<code>False</code>). Furthermore, the output is a <code>Bool</code> which if <code>True</code> implies the <code>follows</code> relationship holds between the input <code>UserId</code>s. For more details on the signatures, see <a href="https://cseweb.ucsd.edu/~npolikarpova/publications/osdi21.pdf">the paper</a>.</p>
<p>Next, update <code>list</code> in <code>src/Controllers/List.hs</code> to use a separate conjunct if the <code>viewer</code> is indeed a follower of <code>userId</code></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="co">{-@ list :: _ -&gt; TaggedT&lt;{\_ -&gt; False}, {\_ -&gt; True}&gt; _ _ _ @-}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a><span class="ot">list ::</span> <span class="dt">UserId</span> <span class="ot">-&gt;</span> <span class="dt">Controller</span> ()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a>list userId <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a>  viewerId  <span class="ot">&lt;-</span> project userId' <span class="op">=&lt;&lt;</span> requireAuthUser</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a>  follower  <span class="ot">&lt;-</span> checkFollower viewerId userId</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>  <span class="kw">let</span> self   <span class="ot">=</span> viewerId <span class="op">==</span> userId</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a>  <span class="kw">let</span> chk</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a>       <span class="op">|</span> self      <span class="ot">=</span> trueF</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a>       <span class="op">|</span> follower  <span class="ot">=</span> itemLevel' <span class="op">&lt;-.</span> [<span class="st">&quot;public&quot;</span>, <span class="st">&quot;follower&quot;</span>]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a>       <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> itemLevel' <span class="op">==.</span> <span class="st">&quot;public&quot;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a>  items     <span class="ot">&lt;-</span> selectList (itemOwner' <span class="op">==.</span> userId <span class="op">&amp;&amp;:</span> chk)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a>  itemDatas <span class="ot">&lt;-</span> mapT (\i <span class="ot">-&gt;</span> </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a>                <span class="dt">ItemData</span> <span class="ot">`fmap`</span> project itemDescription' i</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true"></a>                         <span class="op">&lt;*&gt;</span>    project itemLevel'       i</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true"></a>               )items</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true"></a>  respondJSON status200 itemDatas</span></code></pre></div>
<p>Oops, there is a type error, can you figure it out?</p>
<p><strong>Hint:</strong> Is the query that checks the <em>follower</em> status correct?</p>
<p><br></p>
<h3 id="step-4.-test">Step 4. Test</h3>
<p><br></p>
<p>Now, after fixing the type error, when you run the tests, we’ll see all the right items for users that are indeed followers!</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a><span class="ex">*********</span> add users</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a><span class="ex">********</span> sign-in alice!</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a><span class="ex">********</span> add items for alice</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true"></a><span class="ex">*******</span> logout</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true"></a><span class="ex">********</span> sign-in alice!</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Alice&quot;,&quot;lastName&quot;:&quot;Waters&quot;}</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;marley and me&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;private&quot;</span>},</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;daniel tiger&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;follower&quot;</span>},</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;lupin&quot;,&quot;level&quot;:&quot;follower&quot;}</span>]</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true"></a><span class="ex">********</span> logout</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true"></a><span class="ex">********</span> sign-in bob!</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Robert&quot;,&quot;lastName&quot;:&quot;Barron&quot;}</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>]</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true"></a><span class="ex">********</span> logout</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true"></a><span class="ex">********</span> bob follows alice</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true"></a><span class="ex">********</span> sign-in bob!</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Robert&quot;,&quot;lastName&quot;:&quot;Barron&quot;}</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true"></a> {<span class="st">&quot;description&quot;</span>:<span class="st">&quot;daniel tiger&quot;</span>,<span class="st">&quot;level&quot;</span>:<span class="st">&quot;follower&quot;</span>},</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;lupin&quot;,&quot;level&quot;:&quot;follower&quot;}</span>]</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true"></a><span class="ex">********</span> logout</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true"></a><span class="ex">********</span> sign-in carlos!</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true"></a><span class="dt">{&quot;firstName&quot;:&quot;Carlos&quot;,&quot;lastName&quot;:&quot;Cortado&quot;}</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true"></a><span class="ex">********</span> list items for alice ...</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true"></a>[<span class="dt">{&quot;description&quot;:&quot;katla&quot;,&quot;level&quot;:&quot;public&quot;}</span>,</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true"></a> <span class="dt">{&quot;description&quot;:&quot;counterpart&quot;,&quot;level&quot;:&quot;public&quot;}</span>]</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true"></a><span class="ex">********</span> logout</span></code></pre></div>
<p>Now <code>alice</code> sees <em>all</em> her items, after adding <code>bob</code> as a follower, he sees the public and shared items, but <code>carlos</code> only sees the public ones.</p>
<br>
<hr>
<p><br></p>
<p>While the above should get you started, there are lots of important technical details that we’ve skipped over. Take a look at the <a href="https://cseweb.ucsd.edu/~npolikarpova/publications/osdi21.pdf">OSDI 21 paper</a> for more details or email <a href="about.html">the team</a> if you want to contribute to or use STORM!</p>
    </div>
  </div>
</div>
</article>
<hr>

        </div>
        <div id="footer">
        </div>
      <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://storm-framework.github.io/feed.xml" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/storm-framework" target="_blank">
                            <span class="fa-stack fa-lg">

                              <i class="fa fa-arrow-circle-o-down"></i>
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
		    
                </ul>
                <p class="copyright text-muted">
                
                </p>
            </div>
        </div>
    </div>
</footer>


<!-- jQuery -->
<script src="https://storm-framework.github.io/static/js/jquery.min.js"></script>
<script src="https://storm-framework.github.io/static/js/spaceg.stylesheets.min.js"></script>
<script src="https://storm-framework.github.io/static/js/bootstrap.min.js"></script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
<!-- <script src="https://storm-framework.github.io/static/js/anim.js"></script>
      <script src="https://storm-framework.github.io/static/js/scripts.js"></script>
  -->

    </body>
</html>
